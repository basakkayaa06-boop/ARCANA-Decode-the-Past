<!doctype html>
<html lang="tr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ARCANA : Decode the Past</title>
  
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    /* --- TASARIM AYARLARI --- */
    * { box-sizing: border-box; font-family: 'Times New Roman', Times, serif; }
    
    body {
      margin: 0; padding: 0;
      height: 100vh; width: 100vw; 
      overflow: hidden;
      background-color: #5D4037; 
      background-image: 
        url('resimler/octo.png'), 
        linear-gradient(135deg, rgba(93, 64, 55, 0.9) 0%, rgba(62, 39, 35, 0.95) 100%);
      background-size: 450px 450px, cover; 
      background-repeat: repeat, no-repeat;
      background-position: 80% center, center;
      background-blend-mode: soft-light;
      display: flex; justify-content: center; align-items: center;
      color: #2F1B14;
    }

    .game-container {
      width: 95%; max-width: 950px; height: 98vh;
      background: #F5E6D3; 
      border-radius: 15px; border: 4px solid #8B4513;
      box-shadow: 0 15px 60px rgba(0,0,0,0.95);
      display: flex; flex-direction: column;
      position: relative; padding: 15px;
      z-index: 10;
    }

    /* OYUN ƒ∞√áƒ∞ BA≈ûLIK */
    .game-main-title {
        text-align: center; font-size: 1.8rem; font-weight: bold;
        color: #e65739; 
        margin-bottom: 10px;
        text-shadow: 1px 1px 0px #3E2723;
        letter-spacing: 1px;
        text-transform: uppercase; border-bottom: 2px solid #8B4513;
        padding-bottom: 5px; flex-shrink: 0;
    }

    /* √úST PANEL */
    .header-bar {
        display: flex; justify-content: space-around; align-items: center;
        background: #E8D5C4; padding: 5px 10px; border-radius: 10px;
        border: 2px solid #8B4513; margin-bottom: 5px; font-weight: bold; font-size: 0.95rem;
        flex-wrap: wrap; flex-shrink: 0;
    }
    .info-box-header {
        background: rgba(255,255,255,0.6); padding: 4px 8px;
        border-radius: 6px; border: 1px solid #Bcaaa4; margin: 2px;
    }

    /* OYUN ALANI */
    .game-area {
      flex: 1; display: flex; flex-direction: column; overflow: hidden; 
      background: #fff; border-radius: 12px; border: 2px solid #D2691E;
      padding: 10px; position: relative;
    }

    .image-box {
      flex: 1; min-height: 0; 
      background: #2c1810; border-radius: 8px;
      overflow: hidden; display: flex; align-items: center; justify-content: center;
      margin-bottom: 10px; border: 2px solid #5D4037; position: relative;
    }
    .image-box img { width: 100%; height: 100%; object-fit: contain; display: block; }

    .question-text {
      font-size: 1.2rem; font-weight: bold; color: #8B4513;
      text-align: center; margin-bottom: 10px; flex-shrink: 0; min-height: 40px;
      display: flex; align-items: center; justify-content: center;
    }

    .options-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
      height: auto; flex-shrink: 0; margin-bottom: 5px;
    }
    .opt-btn {
      background: #EFEBE9; border: 2px solid #8B4513; border-radius: 8px;
      color: #3E2723; font-weight: bold; cursor: pointer; font-size: 0.95rem;
      transition: all 0.1s; display: flex; align-items: center; justify-content: center;
      padding: 8px 2px; text-align: center; min-height: 45px;
    }
    .opt-btn:hover:not(:disabled) { background: #D2691E; color: white; transform: translateY(-2px); }
    .opt-btn.correct { background: #4CAF50 !important; color: white; border-color: #2E7D32; }
    .opt-btn.incorrect { background: #f44336 !important; color: white; border-color: #C62828; }
    .opt-btn:disabled { opacity: 0.7; cursor: not-allowed; }

    /* JOKER ALANI */
    .joker-container {
        display: flex; justify-content: center; gap: 8px; margin-bottom: 5px; flex-shrink: 0;
    }
    .joker-btn {
        background: #FFB300; color: #3E2723; border: 2px solid #FF6F00;
        border-radius: 50px; padding: 5px 10px; font-weight: bold; cursor: pointer;
        display: flex; align-items: center; gap: 4px; box-shadow: 0 3px 0 #E65100;
        transition: all 0.2s; font-size: 0.8rem;
    }
    .joker-btn:hover:not(:disabled) { transform: translateY(-2px); background: #FFC107; }
    .joker-btn:active:not(:disabled) { transform: translateY(2px); box-shadow: none; }
    .joker-btn:disabled { background: #Bcaaa4; color: #666; border-color: #8D6E63; box-shadow: none; cursor: default; opacity: 0.6; }

    /* ALT PANEL */
    .bottom-bar {
        height: 60px; margin-top: 5px; flex-shrink: 0;
        display: flex; align-items: center; justify-content: space-between;
        background: #EFEBE9; border-radius: 10px; padding: 5px 10px;
        border: 1px solid #ccc;
    }
    .info-text {
        font-size: 0.95rem; color: #333; flex: 1; margin-right: 10px;
        display: flex; align-items: center; height: 100%;
        font-family: 'Segoe UI', sans-serif; overflow-y: auto; line-height: 1.2;
    }
    .info-success { color: #2E7D32; font-weight: bold; }
    .info-error { color: #C62828; font-weight: bold; }
    .info-hint { color: #0277BD; font-weight: bold; }

    .next-btn {
        background: #8B4513; color: white; border: none; padding: 0 20px;
        height: 35px; font-size: 0.9rem; border-radius: 8px; 
        cursor: pointer; font-weight: bold; flex-shrink: 0;
        box-shadow: 0 3px 0 #5D4037; visibility: hidden;
    }
    .next-btn.visible { visibility: visible; }
    .next-btn:active { transform: translateY(3px); box-shadow: none; }

    /* --- BA≈ûLANGI√á EKRANI √ñZELLE≈ûTƒ∞RMELERƒ∞ --- */
    #startScreen h1 {
        font-size: 3.5rem; font-weight: 900; 
        color: #e1ad3d; 
        text-shadow: 3px 3px 0px #3E2723; margin-bottom: 10px;
        text-transform: uppercase; letter-spacing: 2px;
    }
    
    .start-images-container {
        display: flex; justify-content: center; gap: 30px; margin: 25px 0;
    }
    
    /* YENƒ∞ YAPI: Resim ve √áer√ßevenin Kapsayƒ±cƒ±sƒ± */
    .start-img-box {
        width: 170px; height: 170px; /* Toplam alan kare */
        position: relative; /* ƒ∞√ßindekileri absolute ile yerle≈ütirmek i√ßin */
        display: flex; justify-content: center; align-items: center;
        transition: transform 0.3s;
    }
    .start-img-box:hover { transform: scale(1.08) rotate(3deg); }

    /* KARE RESƒ∞M (Altta) */
    .start-img-rect {
        width: auto; height: auto;
        max-width: 100%; max-height: 100%;
        object-fit: contain;
        /* Kare olduƒüu i√ßin border-radius yok */
        background: rgba(255,255,255,0.15); /* Hafif arka plan */
        padding: 25px; /* √áer√ßevenin i√ßine tam oturmasƒ± ve yazƒ±nƒ±n okunmasƒ± i√ßin */
    }

    /* DAƒ∞RESEL √áER√áEVE (√ústte) */
    .start-img-overlay-border {
        position: absolute;
        top: 0; left: 0;
        width: 100%; height: 100%;
        border-radius: 50%; /* Tam daire */
        border: 4px solid #D2691E; /* Turuncu kenarlƒ±k */
        box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        pointer-events: none; /* Tƒ±klamalarƒ± engelle, alttaki resme ge√ßsin */
    }

    /* ALT YAZI */
    .start-subtitle {
        font-size: 1.6rem; 
        line-height: 1.5; 
        max-width: 85%;
        color: #80c7a0; 
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.8); 
        margin-bottom: 20px;
    }

    #rateBtnLink {
        display: none; text-align: center; margin-top: 5px; padding: 8px 0;
        background: #0288D1; color: white; text-decoration: none; 
        border-radius: 8px; border: 2px solid #01579B; font-weight: bold; 
        font-family: 'Segoe UI', sans-serif; box-shadow: 0 3px 0 #01579B;
        transition: all 0.2s; width: 100%; font-size: 0.9rem; flex-shrink: 0;
    }
    #rateBtnLink:hover { transform: translateY(-2px); background: #039BE5; }

    /* Overlayler */
    .overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(62, 39, 35, 0.98); z-index: 100;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      color: #F5E6D3; border-radius: 12px; text-align: center;
    }
    .hidden { display: none; }
    .level-up-overlay {
        position: absolute; top:0; left:0; width:100%; height:100%;
        background: rgba(44, 24, 16, 0.98); color: #FFECB3;
        display: none; flex-direction: column; justify-content: center; align-items: center;
        z-index: 50; animation: fadeIn 0.5s; text-align: center; padding: 20px;
    }
    .level-up-title { font-size: 2.5rem; color:#FFD700; margin-bottom: 15px; text-shadow: 0 0 10px #E65100; }
    .level-up-msg { font-size: 1.4rem; color:#F5E6D3; margin-bottom: 15px; line-height: 1.5; max-width: 80%; }

    .big-btn {
        margin-top: 25px; padding: 15px 50px; font-size: 1.5rem;
        background: #D2691E; color: white; border: none; border-radius: 50px;
        cursor: pointer; font-weight: bold; box-shadow: 0 5px 0 #8B4513;
        transition: transform 0.2s;
    }
    .big-btn:hover { transform: scale(1.05); }

    .sad-emoji { position: fixed; font-size: 4rem; pointer-events: none; z-index: 9999; animation: floatUp 2s ease-out forwards; }
    @keyframes floatUp { 0% { transform: translateY(0); opacity: 0; } 100% { transform: translateY(-100px); opacity: 0; } }
    @keyframes fadeIn { from {opacity:0} to {opacity:1}}

    /* MOBƒ∞L UYUMLULUK */
    @media (max-width: 600px) {
        .game-container { width: 100%; height: 100vh; border: none; border-radius: 0; padding: 8px; }
        .game-main-title { font-size: 1.3rem; margin-bottom: 5px; }
        .header-bar { font-size: 0.8rem; padding: 3px; }
        .info-box-header { padding: 2px 5px; }
        .game-area { padding: 5px; border-width: 1px; }
        .question-text { font-size: 1rem; min-height: 30px; margin-bottom: 5px; }
        .opt-btn { font-size: 0.85rem; padding: 5px; min-height: 40px; }
        .joker-btn { font-size: 0.75rem; padding: 4px 8px; }
        .bottom-bar { height: 50px; }
        #startScreen h1 { font-size: 2.2rem !important; }
        /* Mobilde boyutlar */
        .start-img-box { width: 130px; height: 130px; }
        .start-img-rect { padding: 18px; }
        .start-subtitle { font-size: 1.2rem; }
        .big-btn { padding: 10px 30px; font-size: 1.2rem; }
    }
  </style>
 </head>
 <body>

  <audio id="sndCorrect" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
  <audio id="sndWrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>
  <audio id="sndLevelUp" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

  <div class="game-container">
    
    <div class="game-main-title">ARCANA : Decode the Past</div>

    <div class="header-bar">
        <div class="info-box-header">SEVƒ∞YE: <span id="uiLevel" style="color:#D2691E">1</span>/3</div>
        <div class="info-box-header">SORU: <span id="qDisplay">1</span>/30</div>
        <div class="info-box-header" style="color:#8B4513; border-color:#8B4513; background:#fff;">
            ‚è±Ô∏è <span id="uiTimer">05:00</span>
        </div>
        <div class="info-box-header">PUAN: <span id="uiScore" style="color:#2E7D32">0</span> / 100</div>
        <div class="info-box-header"><span id="uiLives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span></div>
    </div>

    <div class="game-area">
      <div class="image-box">
        <img id="gameImg" src="" alt="" onerror="this.style.display='none'">
      </div>

      <div class="question-text" id="qText">...</div>
      <div class="options-grid" id="optContainer"></div>

      <div class="joker-container">
          <button id="joker5050" class="joker-btn" onclick="useKarbon14()" title="Yanlƒ±≈ü iki ≈üƒ±kkƒ± eler">
              üß™ Karbon-14
          </button>
          <button id="jokerHint" class="joker-btn" onclick="useRehber()" title="ƒ∞pucu g√∂sterir">
              üìú Rehberin Notlarƒ±
          </button>
          <button id="jokerSkip" class="joker-btn" onclick="useYeniKatman()" title="Soruyu pas ge√ßer">
              ‚õèÔ∏è Yeni Katman
          </button>
      </div>

      <div class="bottom-bar">
          <div id="infoText" class="info-text"></div>
          <button id="nextBtn" class="next-btn" onclick="nextQuestion()">ƒ∞LERƒ∞ ‚û°Ô∏è</button>
      </div>
      
      <div id="levelUpScreen" class="level-up-overlay">
          <h1 id="levelUpTitle" class="level-up-title">SEVƒ∞YE ATLADIN!</h1>
          <p id="levelUpMsg" class="level-up-msg">Tebrikler...</p>
          <p style="font-size:1rem; color:#81C784;">(S√ºre Yenilendi: 5 Dakika)</p>
      </div>
    </div>

    <a id="rateBtnLink" 
       href="https://docs.google.com/forms/d/e/1FAIpQLSeTnoEX1LFJdLEzwA_bjVyoVEQf9eDSGgOmyObGDI7iDZTJtg/viewform?usp=dialog" 
       target="_blank">
       OYUNU DEƒûERLENDƒ∞R ‚≠ê
    </a>

    <div id="startScreen" class="overlay">
        <h1>ARCANA<br><span style="font-size:1.8rem; font-weight:normal;">Decode the Past</span></h1>
        
        <div class="start-images-container">
            <div class="start-img-box">
                <img src="resimler/octo.png" alt="Ahtapot" class="start-img-rect">
                <div class="start-img-overlay-border"></div>
            </div>
            <div class="start-img-box">
                <img src="resimler/unearthed.png" alt="Kazƒ±" class="start-img-rect">
                <div class="start-img-overlay-border"></div>
            </div>
        </div>

        <p class="start-subtitle">
            Haydi bakalƒ±m hafƒ±zamƒ±zƒ± tazeleyelim,<br>yeni bilgiler √∂ƒürenelim!
        </p>
        <button class="big-btn" onclick="startGame()">KAZIYA BA≈ûLA</button>
    </div>

    <div id="endScreen" class="overlay hidden">
        <h1 id="endTitle">OYUN Bƒ∞TTƒ∞</h1>
        <h2 id="endScore" style="font-size:3rem; color:#FFD700; text-shadow:0 0 10px #000;">0 Puan</h2>
        <p id="endMsg" style="margin-top:10px; font-size:1.3rem; font-weight:bold; padding:0 20px; color:#F5E6D3"></p>
        <button class="big-btn" onclick="location.reload()">BA≈ûA D√ñN</button>
    </div>
  </div>

  <script>
    // SORULAR
    const questions = [
      { file: "gobeklitepe.png", q: "Tarihin sƒ±fƒ±r noktasƒ± G√∂beklitepe hangi ilimizdedir?", opts: ["Mardin", "≈ûanlƒ±urfa", "Antep", "Diyarbakƒ±r"], a: 1, info: "12.000 yƒ±llƒ±k bu tapƒ±nak, 'Peygamberler ≈ûehri' olarak bilinen ilimizdedir." },
      { file: "efes.png", q: "Efes Antik Kenti nerededir?", opts: ["ƒ∞zmir", "Aydƒ±n", "Muƒüla", "Antalya"], a: 0, info: "Meryem Ana Evi'ne de ev sahipliƒüi yapan, Ege'nin incisi olan ilimizdedir." },
      { file: "truva.png", q: "Truva Atƒ± ile √ºnl√º kent nerededir?", opts: ["Bursa", "Balƒ±kesir", "√áanakkale", "ƒ∞zmir"], a: 2, info: "Boƒüazƒ±n kƒ±yƒ±sƒ±nda, ≈ûehitler Abidesi ile bilinen kahraman ≈üehrimizdedir." },
      { file: "nemrut.png", q: "Nemrut Daƒüƒ± heykelleri hangi ildedir?", opts: ["Malatya", "Adƒ±yaman", "Elazƒ±ƒü", "Van"], a: 1, info: "Kommagene Krallƒ±ƒüƒ±'na ait heykeller, √ßiƒü k√∂ftesiyle √ºnl√º ilimizdedir." },
      { file: "pamukkale.png", q: "Pamukkale Hierapolis nerededir?", opts: ["Denizli", "Afyon", "Muƒüla", "Aydƒ±n"], a: 0, info: "Beyaz travertenler, horozuyla me≈ühur olan Ege ilimizdedir." },
      { file: "kapadokya.png", q: "Peri Bacalarƒ± (Kapadokya) hangi b√∂lgededir?", opts: ["Nev≈üehir", "Konya", "Kayseri", "Sivas"], a: 0, info: "G√ºzel Atlar √úlkesi olarak bilinir, ƒ∞√ß Anadolu'nun turizm merkezidir." },
      { file: "sumela.png", q: "S√ºmela Manastƒ±rƒ± hangi ildedir?", opts: ["Rize", "Artvin", "Trabzon", "Ordu"], a: 2, info: "Sarp kayalƒ±klara kurulu bu manastƒ±r, hamsi ve horonun ba≈ükentindedir." },
      { file: "kizkulesi.png", q: "Kƒ±z Kulesi hangi ilimizdedir?", opts: ["ƒ∞stanbul", "ƒ∞zmir", "√áanakkale", "Mersin"], a: 0, info: "ƒ∞ki kƒ±tayƒ± birbirine baƒülayan, boƒüazƒ±n incisi metropol√ºm√ºzdedir." },
      { file: "anitkabir.png", q: "Anƒ±tkabir hangi ilimizdedir?", opts: ["ƒ∞stanbul", "Ankara", "Samsun", "ƒ∞zmir"], a: 1, info: "Kurtulu≈ü Sava≈üƒ±'nƒ±n y√∂netildiƒüi, T√ºrkiye'nin kalbi olan ba≈ükentimizdedir." },
      { file: "aspendos.png", q: "Aspendos Tiyatrosu nerededir?", opts: ["Muƒüla", "Mersin", "Antalya", "Hatay"], a: 2, info: "T√ºrkiye'nin turizm ba≈ükenti olan, portakalƒ±yla √ºnl√º Akdeniz ≈üehrimizdedir." },
      // SEVƒ∞YE 2
      { file: "catalhoyuk.png", q: "√áatalh√∂y√ºk antik kenti nerededir?", opts: ["Konya", "Aksaray", "Ankara", "Karaman"], a: 0, info: "ƒ∞nsanlƒ±k tarihinin ilk ≈üehir yerle≈üimi, Mevlana'nƒ±n ≈üehrindedir." },
      { file: "zeugma.png", q: "Zeugma Mozaik M√ºzesi nerededir?", opts: ["Hatay", "Gaziantep", "≈ûanlƒ±urfa", "Adana"], a: 1, info: "√áingene Kƒ±zƒ± mozaiƒüi, baklavasƒ± ve mutfaƒüƒ±yla √ºnl√º ilimizdedir." },
      { file: "hattusas.png", q: "Hitit ba≈ükenti Hattu≈üa≈ü nerededir?", opts: ["√áorum", "Yozgat", "Amasya", "Tokat"], a: 0, info: "Hititlerin ba≈ükenti, leblebisiyle √ºnl√º ilimizdedir." },
      { file: "akdamar.png", q: "Akdamar Kilisesi hangi g√∂ldedir?", opts: ["Tuz G√∂l√º", "Bey≈üehir", "Van G√∂l√º", "Eƒüirdir"], a: 2, info: "T√ºrkiye'nin en b√ºy√ºk g√∂l√ºndeki adadadƒ±r. Kedisiyle me≈ühurdur." },
      { file: "bergama.png", q: "Bergama (Pergamon) nerededir?", opts: ["Manisa", "ƒ∞zmir", "Balƒ±kesir", "√áanakkale"], a: 1, info: "Par≈ü√∂menin icat edildiƒüi yerdir. Ege'nin en b√ºy√ºk √º√ß√ºnc√º ilindedir." },
      { file: "gordion.png", q: "Kral Midas'ƒ±n mezarƒ± Gordion nerededir?", opts: ["Eski≈üehir", "K√ºtahya", "Afyon", "Ankara"], a: 3, info: "Frig ba≈ükenti Gordion, tiftik ke√ßisiyle √ºnl√º ba≈ükentimizdedir." },
      { file: "myra.png", q: "Noel Baba ile bilinen Myra nerededir?", opts: ["Antalya", "Muƒüla", "Mersin", "Isparta"], a: 0, info: "Noel Baba kilisesi buradadƒ±r. T√ºrkiye'nin en sƒ±cak turizm kentindedir." },
      { file: "harran.png", q: "K√ºmbet evleriyle √ºnl√º Harran nerededir?", opts: ["Mardin", "≈ûanlƒ±urfa", "Batman", "Siirt"], a: 1, info: "Konik kubbeli evleriyle me≈ühurdur. Balƒ±klƒ±g√∂l bu ilimizdedir." },
      { file: "ishakpasa.png", q: "ƒ∞shak Pa≈üa Sarayƒ± nerededir?", opts: ["Kars", "Erzurum", "Aƒürƒ±", "Iƒüdƒ±r"], a: 2, info: "Doƒüunun incisi bu saray, T√ºrkiye'nin en y√ºksek daƒüƒ±nƒ±n eteklerindedir." },
      { file: "hasankeyf.png", q: "Ilƒ±su Barajƒ± altƒ±nda kalan Hasankeyf nerededir?", opts: ["Mardin", "Batman", "Diyarbakƒ±r", "Siirt"], a: 1, info: "Dicle nehri kƒ±yƒ±sƒ±nda, petrol√ºyle bilinen ≈üehrimizdedir." },
      // SEVƒ∞YE 3
      { file: "giza.png", q: "Giza Piramitleri hangi √ºlkededir?", opts: ["Mƒ±sƒ±r", "Fas", "Tunus", "Sudan"], a: 0, info: "Nil nehrinin kƒ±yƒ±sƒ±nda, firavunlar √ºlkesindedir." },
      { file: "cinseddi.png", q: "√áin Seddi'ni ba≈ülatan imparator kimdir?", opts: ["Qin Shi Huang", "Ming", "Han", "Tang"], a: 0, info: "Uzaydan g√∂r√ºlebildiƒüi s√∂ylenen bu yapƒ±, Uzak Doƒüu'nun ejderhasƒ±dƒ±r." },
      { file: "machupicchu.png", q: "Machu Picchu hangi √ºlkededir?", opts: ["Meksika", "≈ûili", "Peru", "Brezilya"], a: 2, info: "ƒ∞nka medeniyetinin kayƒ±p ≈üehri, G√ºney Amerika'nƒ±n batƒ± kƒ±yƒ±sƒ±ndadƒ±r." },
      { file: "petra.png", q: "Kayalara oyulu Petra antik kenti nerededir?", opts: ["√úrd√ºn", "L√ºbnan", "Suriye", "Mƒ±sƒ±r"], a: 0, info: "Kayalara oyulmu≈ü bu antik kent, Ortadoƒüu'nun Ha≈üimi Krallƒ±ƒüƒ±'ndadƒ±r." },
      { file: "kolezyum.png", q: "Kolezyum (Colosseum) hangi ≈üehirdedir?", opts: ["Atina", "Roma", "Milano", "Venedik"], a: 1, info: "Gladyat√∂rlerin d√∂v√º≈üt√ºƒü√º bu arena, √áizme ≈üeklindeki √ºlkenin ba≈ükentindedir." },
      { file: "stonehenge.png", q: "Stonehenge hangi √ºlkededir?", opts: ["ƒ∞rlanda", "ƒ∞sko√ßya", "ƒ∞ngiltere", "Galler"], a: 2, info: "Bu gizemli ta≈ülar, Krali√ße ve √ßayƒ±yla √ºnl√º ada √ºlkesindedir." },
      { file: "moai.png", q: "Moai heykelleri (Paskalya Adasƒ±) kime aittir?", opts: ["≈ûili", "Peru", "Arjantin", "Avustralya"], a: 0, info: "Bu dev heykeller, G√ºney Amerika'nƒ±n uzun ve ince √ºlkesine baƒülƒ± bir adadadƒ±r." },
      { file: "tacmahal.png", q: "Tac Mahal hangi √ºlkededir?", opts: ["Pakistan", "Hindistan", "ƒ∞ran", "Banglade≈ü"], a: 1, info: "≈ûah Cihan'ƒ±n a≈ükƒ± i√ßin yaptƒ±rdƒ±ƒüƒ± bu anƒ±t, baharatlarƒ±yla √ºnl√º √ºlkededir." },
      { file: "chichenitza.png", q: "Maya piramidi Chichen Itza nerededir?", opts: ["Meksika", "Peru", "Brezilya", "Kolombiya"], a: 0, info: "Mayalarƒ±n bu piramidi, takolarƒ± ve ≈üapkalarƒ±yla √ºnl√º √ºlkededir." },
      { file: "parthenon.png", q: "Akropolis'teki Parthenon tapƒ±naƒüƒ± nerededir?", opts: ["Roma", "Atina", "Selanik", "Girit"], a: 1, info: "Kom≈üumuzun ba≈ükentinde, felsefe ve demokrasinin doƒüduƒüu yerdedir." }
    ];

    let idx = 0;
    let score = 0;
    let lives = 5;
    let time = 300; 
    let timer;
    let joker5050Used = false;
    let jokerHintUsed = false;
    let jokerSkipUsed = false;

    const imgEl = document.getElementById('gameImg');
    const qEl = document.getElementById('qText');
    const optEl = document.getElementById('optContainer');
    const infoText = document.getElementById('infoText');
    const nextBtn = document.getElementById('nextBtn');
    const levelUpScreen = document.getElementById('levelUpScreen');
    const rateBtnLink = document.getElementById('rateBtnLink');
    const btn5050 = document.getElementById('joker5050');
    const btnHint = document.getElementById('jokerHint');
    const btnSkip = document.getElementById('jokerSkip');
    
    function playSound(type) {
        const audio = document.getElementById(type === 'correct' ? 'sndCorrect' : (type === 'levelUp' ? 'sndLevelUp' : 'sndWrong'));
        audio.currentTime = 0;
        audio.play().catch(e => {});
    }

    function startGame() {
        document.getElementById('startScreen').classList.add('hidden');
        startTimer();
        loadQuestion();
    }

    function startTimer() {
        if (timer) clearInterval(timer);
        timer = setInterval(() => {
            time--;
            let m = Math.floor(time / 60);
            let s = time % 60;
            document.getElementById('uiTimer').innerText = `${m}:${s<10?'0'+s:s}`;
            if (time <= 0) {
                clearInterval(timer);
                endGame();
            }
        }, 1000);
    }

    function loadQuestion() {
        nextBtn.classList.remove('visible');
        infoText.innerHTML = '';
        
        if (idx === 10) { 
            time = 300; document.getElementById('uiTimer').innerText = "5:00";
            showLevelUp(2);
            rateBtnLink.style.display = 'block';
        }
        else if (idx === 20) { 
            time = 300; document.getElementById('uiTimer').innerText = "5:00";
            showLevelUp(3); 
        }

        if (idx >= questions.length) { endGame(true); return; }

        const data = questions[idx];
        qEl.innerText = data.q;
        imgEl.style.display = 'block';
        imgEl.src = "resimler/" + data.file;
        imgEl.onload = () => { imgEl.style.opacity = '1'; };
        imgEl.onerror = () => { imgEl.style.display = 'none'; }; 
        
        optEl.innerHTML = "";
        let indices = [0, 1, 2, 3];
        indices.sort(() => Math.random() - 0.5);

        indices.forEach(i => {
            let btn = document.createElement("button");
            btn.className = "opt-btn";
            btn.innerText = data.opts[i];
            btn.onclick = () => checkAnswer(i, data.a, btn, data);
            optEl.appendChild(btn);
        });

        let currentLevel = 1;
        if (idx >= 10) currentLevel = 2;
        if (idx >= 20) currentLevel = 3;
        document.getElementById('uiLevel').innerText = currentLevel;
        document.getElementById('qDisplay').innerText = idx + 1;
    }

    function showLevelUp(level) {
        playSound('levelUp');
        const titleEl = document.getElementById('levelUpTitle');
        const msgEl = document.getElementById('levelUpMsg');
        if (level === 2) {
            titleEl.innerText = "TEBRƒ∞KLER! 2. SEVƒ∞YEDESƒ∞N üè∫";
            msgEl.innerText = "Harika gidiyorsun! Anadolu'nun sƒ±rlarƒ±nƒ± √ß√∂zd√ºn, ≈üimdi daha derinlere inme vakti.";
        } else if (level === 3) {
            titleEl.innerText = "MUHTE≈ûEM! 3. SEVƒ∞YEDESƒ∞N üíé";
            msgEl.innerText = "Zirveye √ßok yakƒ±nsƒ±n! Ger√ßek bir uzman gibi d√ºnya mirasƒ±nƒ± ke≈üfet!";
        }
        levelUpScreen.style.display = 'flex';
        setTimeout(() => { levelUpScreen.style.display = 'none'; }, 4000);
    }

    // --- JOKERLER ---
    function useKarbon14() {
        if (joker5050Used || nextBtn.classList.contains('visible')) return;
        const data = questions[idx];
        const allBtns = Array.from(document.querySelectorAll('.opt-btn'));
        const incorrectBtns = allBtns.filter(btn => btn.innerText !== data.opts[data.a]);
        incorrectBtns.sort(() => Math.random() - 0.5);
        incorrectBtns.slice(0, 2).forEach(btn => {
            btn.disabled = true; btn.style.opacity = '0.3';
        });
        joker5050Used = true;
        btn5050.disabled = true;
    }

    function useRehber() {
        if (jokerHintUsed || nextBtn.classList.contains('visible')) return;
        const data = questions[idx];
        infoText.innerHTML = `<span class='info-hint'>üí° ƒ∞PUCU:</span> ${data.info}`;
        jokerHintUsed = true;
        btnHint.disabled = true;
    }

    function useYeniKatman() {
        if (jokerSkipUsed || nextBtn.classList.contains('visible')) return;
        jokerSkipUsed = true;
        btnSkip.disabled = true;
        idx++; loadQuestion();
    }

    function checkAnswer(selected, correct, btn, data) {
        if (nextBtn.classList.contains('visible')) return;
        const allBtns = document.querySelectorAll('.opt-btn');
        let pointsToAdd = 3; if (idx >= 20) pointsToAdd = 4;

        if (selected === correct) {
            btn.classList.add('correct'); playSound('correct');
            score += pointsToAdd; document.getElementById('uiScore').innerText = score;
            infoText.innerHTML = "<span class='info-success'>‚úÖ DOƒûRU!</span>";
            triggerConfetti();
        } else {
            btn.classList.add('incorrect'); playSound('wrong');
            lives--; document.getElementById('uiLives').innerText = "‚ù§Ô∏è".repeat(Math.max(0, lives));
            
            // Yanlƒ±≈üta da ƒ∞pucu G√∂sterilsin
            infoText.innerHTML = `<span class='info-error'>‚ùå YANLI≈û!</span> ${data.info}`;
            
            triggerSadFaces();
            allBtns.forEach(b => { if (b.innerText === data.opts[correct]) b.classList.add('correct'); });
            if (lives <= 0) { setTimeout(() => endGame(false), 2500); return; }
        }
        allBtns.forEach(b => b.disabled = true);
        nextBtn.classList.add('visible');
    }

    function nextQuestion() { idx++; loadQuestion(); }

    function endGame(isWin) {
        clearInterval(timer);
        document.getElementById('endScreen').classList.remove('hidden');
        document.getElementById('endTitle').innerText = "OYUN Bƒ∞TTƒ∞";
        document.getElementById('endScore').innerText = score + " Puan";
        let msg = "";
        if (score === 100) msg = "TEBRƒ∞KLER KA≈ûƒ∞F! üè∫\nMuhte≈üem bir hafƒ±zan var!";
        else if (score >= 80) msg = "Harika ƒ∞≈ü! Neredeyse t√ºm sƒ±rlarƒ± √ß√∂zd√ºn.";
        else msg = "G√ºzel √ßaba, ama biraz daha ara≈ütƒ±rmalƒ±sƒ±n.";
        document.getElementById('endMsg').innerText = msg;
        if(isWin) triggerConfetti();
    }

    function triggerConfetti() { if (typeof confetti === 'function') confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } }); }
    function triggerSadFaces() {
        const emojis = ['üò¢', 'üíî', 'üò≠', '‚òπÔ∏è', '‚ùå'];
        for (let i = 0; i < 5; i++) {
            const el = document.createElement('div');
            el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
            el.className = 'sad-emoji';
            el.style.left = (Math.random() * 80 + 10) + 'vw'; 
            el.style.top = (Math.random() * 50 + 40) + 'vh';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 2000);
        }
    }
  </script>
 </body>
</html>
